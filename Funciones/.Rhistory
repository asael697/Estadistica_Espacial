post1 = sampling(y = y, scale = scale_mat, iter = 2000, thin = 1, h = 0.005, MALA = TRUE)
print( Sys.time() - start)
colnames(post1) = c("mu","sigma","acceptence_rate",".chain")
post1_df = as_draws_df(post1)
summarise_draws(post1_df)
source("Funciones/functions.R")
scale_mat = matrix(c(5,1,1,3),ncol = 2)
#scale_mat = 0.5*diag(2)
start = Sys.time()
post1 = sampling(y = y, scale = scale_mat, iter = 2000, thin = 1, h = 0.001, MALA = TRUE)
print( Sys.time() - start)
colnames(post1) = c("mu","sigma","acceptence_rate",".chain")
post1_df = as_draws_df(post1)
summarise_draws(post1_df)
mcmc_combo(post1_df,pars = c("mu","sigma"))
source("Funciones/functions.R")
scale_mat = matrix(c(5,0.5,0.5,3),ncol = 2)
#scale_mat = 0.5*diag(2)
start = Sys.time()
post1 = sampling(y = y, scale = scale_mat, iter = 2000, thin = 1, h = 0.001, MALA = TRUE)
print( Sys.time() - start)
colnames(post1) = c("mu","sigma","acceptence_rate",".chain")
post1_df = as_draws_df(post1)
summarise_draws(post1_df)
mcmc_combo(post1_df,pars = c("mu","sigma"))
source("Funciones/functions.R")
scale_mat = matrix(c(5,0.1,0.1,1.5),ncol = 2)
#scale_mat = 0.5*diag(2)
start = Sys.time()
post1 = sampling(y = y, scale = scale_mat, iter = 2000, thin = 1, h = 0.001, MALA = TRUE)
print( Sys.time() - start)
colnames(post1) = c("mu","sigma","acceptence_rate",".chain")
post1_df = as_draws_df(post1)
summarise_draws(post1_df)
mcmc_combo(post1_df,pars = c("mu","sigma"))
source("Funciones/functions.R")
scale_mat = matrix(c(5,0.1,0.1,1),ncol = 2)
#scale_mat = 0.5*diag(2)
start = Sys.time()
post1 = sampling(y = y, scale = scale_mat, iter = 2000, thin = 1, h = 0.001, MALA = TRUE)
print( Sys.time() - start)
colnames(post1) = c("mu","sigma","acceptence_rate",".chain")
post1_df = as_draws_df(post1)
summarise_draws(post1_df)
mcmc_combo(post1_df,pars = c("mu","sigma"))
source("Funciones/functions.R")
scale_mat = matrix(c(5,0.1,0.1,2),ncol = 2)
#scale_mat = 0.5*diag(2)
start = Sys.time()
post1 = sampling(y = y, scale = scale_mat, iter = 2000, thin = 1, h = 0.001, MALA = TRUE)
print( Sys.time() - start)
colnames(post1) = c("mu","sigma","acceptence_rate",".chain")
post1_df = as_draws_df(post1)
summarise_draws(post1_df)
mcmc_combo(post1_df,pars = c("mu","sigma"))
source("Funciones/functions.R")
scale_mat = matrix(c(5,0.1,0.1,2),ncol = 2)
#scale_mat = 0.5*diag(2)
start = Sys.time()
post1 = sampling(y = y, scale = scale_mat, iter = 2000, thin = 1, h = 0.001, MALA = FALSE)
print( Sys.time() - start)
colnames(post1) = c("mu","sigma","acceptence_rate",".chain")
post1_df = as_draws_df(post1)
summarise_draws(post1_df)
mcmc_combo(post1_df,pars = c("mu","sigma"))
source("Funciones/functions.R")
scale_mat = matrix(c(5,0.1,0.1,2),ncol = 2)
#scale_mat = 0.5*diag(2)
start = Sys.time()
post1 = sampling(y = y, scale = scale_mat, iter = 2000, thin = 1, h = 0.01, MALA = FALSE)
print( Sys.time() - start)
colnames(post1) = c("mu","sigma","acceptence_rate",".chain")
post1_df = as_draws_df(post1)
summarise_draws(post1_df)
mcmc_combo(post1_df,pars = c("mu","sigma"))
source("Funciones/functions.R")
scale_mat = matrix(c(5,0.1,0.1,2),ncol = 2)
#scale_mat = 0.5*diag(2)
start = Sys.time()
post1 = sampling(y = y, scale = scale_mat, iter = 2000, thin = 1, h = 0.01, MALA = TRUE)
print( Sys.time() - start)
colnames(post1) = c("mu","sigma","acceptence_rate",".chain")
post1_df = as_draws_df(post1)
summarise_draws(post1_df)
mcmc_combo(post1_df,pars = c("mu","sigma"))
rm(list = ls())
load("~/Documents/Gasto Turismo/Borradores/Gasto.Rdata")
View(EGPV2016)
table(EGPV2016$TipVisitante)
table(EGPV2016$RegRes)
View(ER)
rm(list = ls())
load("~/Documents/Gasto Turismo/Gasto.Rdata")
View(EGPV2016)
View(ER)
rm(list = ls())
library(cmdstanr)
library(cowplot)
library(posterior)
library(bayesplot)
library(ggplot2)
setwd("/Users/asael_am/Documents/GEV-DLMs/Funciones")
source("functions.R")
mod <- cmdstan_model("gev_dlm.stan")
mod1 <- cmdstan_model("GEV-DLM.stan")
n = 259
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -4))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
data_list = list(n = n, y = y, d = 1, phi = 1, m0 = 0, C0 = 100)
fit <- mod$sample(data = data_list, chains = 4, parallel_chains = 4, max_treedepth = 13,
refresh = 500, iter_sampling = 2000, iter_warmup = 4000)
fit$summary(variables = c('k',"scale","tau","sigma"))
preal
mcmc_combo(
fit$draws(variables = c('k',"scale","tau","sigma"))
)
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -2))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -2))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -2))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -2))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -2))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -2))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -2))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -1))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -1))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -1))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
data_list = list(n = n, y = y, d = 1, phi = 1, m0 = 0, C0 = 100)
fit <- mod$sample(data = data_list, chains = 4, parallel_chains = 4, max_treedepth = 13,
refresh = 500, iter_sampling = 2000, iter_warmup = 4000)
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -1))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,preal[3])
plot_ts(y, name = "y",color = "darkblue")
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -1))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -1))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
y1 = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,sd = y0$mt[-1],preal[3])
y1 = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],preal[3])
rnorm(n = n,mean = y0$mt[-1],preal[3])
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,sd = preal[3])
y1 = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y1, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -1))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,sd = preal[3])
y1 = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
plot_ts(y1, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -1))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = y0$mt[-1] + preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,sd = preal[3])
y1 = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
plot_ts(y1, name = "y",color = "darkblue")
n = 259
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -1))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -2))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
data_list = list(n = n, y = y, d = 1, phi = 1, m0 = 0, C0 = 100)
fit <- mod$sample(data = data_list, chains = 4, parallel_chains = 4, max_treedepth = 13,
refresh = 500, iter_sampling = 2000, iter_warmup = 4000)
mod <- cmdstan_model("gev_dlm.stan")
mod1 <- cmdstan_model("GEV-DLM.stan")
n = 259
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -2))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
eta = SpatialExtremes::rgev(n)
y = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -2))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
eta = SpatialExtremes::rgev(n)
y = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -2))
preal
eta = SpatialExtremes::rgev(n)
y = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
data_list = list(n = n, y = y, d = 1, phi = 1, m0 = 0, C0 = 100)
fit <- mod$sample(data = data_list, chains = 4, parallel_chains = 4, max_treedepth = 13,
refresh = 500, iter_sampling = 2000, iter_warmup = 4000)
fit$summary(variables = c('k',"scale","tau","sigma"))
preal
mcmc_combo(
fit$draws(variables = c('k',"scale","tau","sigma"))
)
mod <- cmdstan_model("gev_dlm.stan")
mod <- cmdstan_model("gev_dlm.stan")
mod <- cmdstan_model("gev_dlm.stan")
mod <- cmdstan_model("gev_dlm.stan")
fit <- mod$sample(data = data_list, chains = 4, parallel_chains = 4, max_treedepth = 13,
refresh = 500, iter_sampling = 2000, iter_warmup = 4000)
fit$summary(variables = c('k',"scale","tau","sigma"))
preal
mcmc_combo(
fit$draws(variables = c('k',"scale","tau","sigma"))
)
mcmc_combo(
fit$draws(variables = c('k',"scale","tau","sigma"))
)
preal[3] = 0.01
eta = SpatialExtremes::rgev(n)
y = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal
data_list = list(n = n, y = y, d = 1, phi = 1, m0 = 0, C0 = 100)
fit <- mod$sample(data = data_list, chains = 4, parallel_chains = 4, max_treedepth = 13,
refresh = 500, iter_sampling = 2000, iter_warmup = 4000)
fit$summary(variables = c('k',"scale","tau","sigma"))
preal
mcmc_combo(
fit$draws(variables = c('k',"scale","tau","sigma"))
)
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -2))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -2))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -1))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -1))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -1))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -1))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -3))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -3))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
data_list = list(n = n, y = y, d = 1, phi = 1, m0 = 0, C0 = 100)
fit <- mod$sample(data = data_list, chains = 4, parallel_chains = 4, max_treedepth = 13,
refresh = 500, iter_sampling = 2000, iter_warmup = 4000)
fit$summary(variables = c('k',"scale","tau","sigma"))
preal
mcmc_combo(
fit$draws(variables = c('k',"scale","tau","sigma"))
)
mu_post = fit$draws(variables = "mu",format = "matrix")
eta_post = fit$draws(variables = "eta",format = "matrix")
ppc_ribbon(y = as.numeric(y0$mt),yrep = mu_post)
ppc_ribbon(y = eta,yrep = eta_post)
post = fit$draws(variables = c("k","scale","mu"),format = "matrix")
y_rep = apply(post,1,FUN = function(x){
x = as.numeric(x)
SpatialExtremes::rgev(n,loc = 0,scale = x[2],shape = x[1]) + x[4:262]
})
ppc_ribbon(y = y,yrep = t(y_rep))
ppc_ribbon(y = as.numeric(y0$mt),yrep = mu_post)
ppc_ribbon(y = eta,yrep = eta_post)
post = fit$draws(variables = c("k","scale","mu"),format = "matrix")
y_rep = apply(post,1,FUN = function(x){
x = as.numeric(x)
SpatialExtremes::rgev(n,loc = 0,scale = x[2],shape = x[1]) + x[4:262]
})
ppc_ribbon(y = y,yrep = t(y_rep))
ppc_error_data(y = y,yrep = t(y_rep))
ppc_error_hist(y = y,yrep = t(y_rep))
ppc_ribbon(y = y,yrep = t(y_rep))
ppc_error_hist(y = y,yrep = t(y_rep))
y_rep = apply(post,1,FUN = function(x){
x = as.numeric(x)
y - SpatialExtremes::rgev(n,loc = 0,scale = x[2],shape = x[1]) + x[4:262]
})
ppc_ribbon(y = rnorm(n),yrep = t(y_rep))
ppc_ribbon(y = SpatialExtremes::rgev(n),yrep = t(y_rep))
ppc_dens_overlay(y = SpatialExtremes::rgev(n),yrep = t(y_rep))
plot_ts(y, name = "y",color = "darkblue")
ppc_dens_overlay(y = y, yrep = t(y_rep))
ppc_ribbon(y = y, yrep = t(y_rep))
y_rep = apply(post,1,FUN = function(x){
x = as.numeric(x)
SpatialExtremes::rgev(n,loc = 0,scale = x[2],shape = x[1]) + x[4:262]
})
ppc_dens_overlay(y = y, yrep = t(y_rep))
ppc_ribbon(y = y, yrep = t(y_rep))
n = 259
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -3))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3],W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
data_list = list(n = n, y = y, d = 1, phi = 1, m0 = 0, C0 = 100)
fit <- mod$sample(data = data_list, chains = 4, parallel_chains = 4, max_treedepth = 13,
refresh = 500, iter_sampling = 2000, iter_warmup = 4000)
fit$summary(variables = c('k',"scale","tau","sigma"))
preal
mcmc_combo(
fit$draws(variables = c('k',"scale","tau","sigma"))
)
mu_post = fit$draws(variables = "mu",format = "matrix")
eta_post = fit$draws(variables = "eta",format = "matrix")
ppc_ribbon(y = as.numeric(y0$mt),yrep = mu_post)
ppc_ribbon(y = eta,yrep = eta_post)
post = fit$draws(variables = c("k","scale","mu"),format = "matrix")
y_rep = apply(post,1,FUN = function(x){
x = as.numeric(x)
SpatialExtremes::rgev(n,loc = 0,scale = x[2],shape = x[1]) + x[4:262]
})
ppc_ribbon(y = y, yrep = t(y_rep))
ppc_dens_overlay(y = y, yrep = t(y_rep))
n = 259
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -3))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
data_list = list(n = n, y = y, d = 1, phi = 1, m0 = 0, C0 = 100)
fit <- mod$sample(data = data_list, chains = 4, parallel_chains = 4, max_treedepth = 13,
refresh = 500, iter_sampling = 2000, iter_warmup = 4000)
fit <- mod$sample(data = data_list, chains = 4, parallel_chains = 4, max_treedepth = 13,
refresh = 500, iter_sampling = 2000, iter_warmup = 4000)
fit$summary(variables = c('k',"scale","tau","sigma"))
preal
mcmc_combo(
fit$draws(variables = c('k',"scale","tau","sigma"))
)
preal
preal <- c(rlnorm(1),rnorm(1),rlnorm(1,meanlog = -1))
y0 <- rdlm(n, G = 1, FF = 1, V = preal[3], W = 0.6*preal[3])
plot_ts(y0$mt[-1])
preal
eta = SpatialExtremes::rgev(n)
y = preal[1]*(exp(preal[2]*eta) - 1)/preal[2] + rnorm(n = n,mean = y0$mt[-1],sd = preal[3])
plot_ts(y, name = "y",color = "darkblue")
data_list = list(n = n, y = y, d = 1, phi = 1, m0 = 0, C0 = 100)
fit <- mod$sample(data = data_list, chains = 4, parallel_chains = 4, max_treedepth = 13,
refresh = 500, iter_sampling = 2000, iter_warmup = 4000)
fit$summary(variables = c('k',"scale","tau","sigma"))
preal
mcmc_combo(
fit$draws(variables = c('k',"scale","tau","sigma"))
)
mu_post = fit$draws(variables = "mu",format = "matrix")
eta_post = fit$draws(variables = "eta",format = "matrix")
ppc_ribbon(y = as.numeric(y0$mt),yrep = mu_post)
ppc_ribbon(y = eta,yrep = eta_post)
post = fit$draws(variables = c("k","scale","mu"),format = "matrix")
y_rep = apply(post,1,FUN = function(x){
x = as.numeric(x)
SpatialExtremes::rgev(n,loc = 0,scale = x[2],shape = x[1]) + x[4:262]
})
ppc_ribbon(y = y, yrep = t(y_rep))
ppc_dens_overlay(y = y, yrep = t(y_rep))
plot_ts(y, name = "y",color = "darkblue")
rm(list = ls())
